<!DOCTYPE html>
<html lang="es">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Federic's Pizza - La Pizza MÃ¡s Fresca</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
        body {
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .pizza-bounce {
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 50%, #ffa726 100%);
        }
        
        .hover-scale {
            transition: transform 0.3s ease;
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }

/* Asegurar que el nav tenga posiciÃ³n relativa para el menÃº absoluto */
header nav {
    position: relative;
}

/* Estilos especÃ­ficos para el menÃº mÃ³vil */
#mobileMenu {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
    padding: 1rem;
    z-index: 50;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Asegurar que el menÃº mÃ³vil estÃ© oculto por defecto */
#mobileMenu.hidden {
    display: none;
}

        @media (max-width: 640px) {
    #cartModal > div,
    #friesModal > div, 
    #drinkModal > div,
    #wingsModal > div,
    #breadModal > div,
    #accountModal > div,
    #registerModal > div,
    #loginModal > div,
    #deliveryModal > div,
    #pizzaModal > div,
    #paymentModal > div,
    #cardFormModal > div,
    #paymentSuccessModal > div {
        margin: 1rem;
        width: calc(100% - 2rem);
        max-height: 90vh;
    }
}

/* Estilos mejorados para modales de pago en dispositivos mÃ³viles */
@media (max-width: 640px) {
  #paymentModal > div,
  #cardFormModal > div,
  #paymentSuccessModal > div {
    margin: 0.5rem;
    width: calc(100% - 1rem);
    max-height: 95vh;
    border-radius: 1rem;
  }
  
  #cardForm input {
    font-size: 16px; /* Previene zoom en iOS */
    padding: 12px;
  }
  
  .gradient-bg.p-6 {
    padding: 1rem;
  }
  
  .gradient-bg h3 {
    font-size: 1.5rem;
  }
}

/* Mejoras visuales para el formulario de pago */
#cardForm input:focus {
  border-color: #ff6b35;
  box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
}

#cardNumber {
  letter-spacing: 1px;
  font-family: 'Courier New', monospace;
}

/* Estilos para estados de carga */
.loading {
  opacity: 0.7;
  pointer-events: none;
}

.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid #f3f3f3;
  border-top: 2px solid #ff6b35;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

    </style>

</head>
<body class="bg-white">
<header class="gradient-bg shadow-lg">
<nav class="container mx-auto px-4 md:px-6 py-4">
<div class="flex items-center justify-between">
<div class="flex items-center space-x-3">
<img alt="Federic's Pizza Logo" class="h-10 w-10 md:h-14 md:w-14 rounded-full pizza-bounce" src="https://i.imgur.com/EDWicBS.jpeg"/>
<h1 class="text-3xl font-bold text-white">Federic's Pizza</h1>
</div>
<div class="md:hidden">
    <button id="mobileMenuButton" class="text-white text-2xl">â˜°</button>
</div>

<div class="hidden md:flex space-x-8">
<a class="text-white hover:text-orange-200 font-medium transition-colors" href="#cuenta" id="accountButton">Cuenta</a>
<a class="text-white hover:text-orange-200 font-medium transition-colors" href="#inicio">Inicio</a>
<a class="text-white hover:text-orange-200 font-medium transition-colors" href="#menu">MenÃº</a>
<a class="text-white hover:text-orange-200 font-medium transition-colors" href="#nosotros">Nosotros</a>
<a class="text-white hover:text-orange-200 font-medium transition-colors" href="#contacto">Contacto</a>
<a class="text-white hover:text-orange-200 font-medium transition-colors cursor-pointer" id="helpButton">Ayuda</a>
</div>
<div class="flex items-center space-x-4">
<button class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-full font-semibold hover:bg-white hover:bg-opacity-30 transition-colors flex items-center space-x-2" id="cartButton">
<span>ğŸ›’</span>
<span id="cartCount">0</span>
</button>
</div>
</div>
</nav>
</header>
<section class="gradient-bg py-12 md:py-20" id="inicio">
<div class="container mx-auto px-4 md:px-6 text-center">
<img alt="Federic's Pizza Logo" class="mx-auto h-24 w-24 md:h-32 md:w-32 mb-6 pizza-bounce rounded-full" src="https://i.imgur.com/EDWicBS.jpeg"/>
<h2 class="text-3xl md:text-5xl font-bold text-white mb-6">Â¡La Pizza MÃ¡s Fresca de la Ciudad!</h2>
<p class="text-base md:text-xl text-orange-100 mb-8 max-w-2xl mx-auto">
                Ingredientes frescos, sabores Ãºnicos y la mejor experiencia para jÃ³venes que aman la buena comida
            </p>
<div class="flex flex-col sm:flex-row gap-4 justify-center">
  <a href="#menu" class="bg-white text-orange-500 px-4 md:px-8 py-3 md:py-4 rounded-full font-bold text-sm md:text-lg">Ver MenÃº ğŸ“‹</a>
  <button class="border-2 border-white text-white px-4 md:px-8 py-3 md:py-4 rounded-full font-bold text-sm md:text-lg">
                    Delivery Gratis ğŸšš
                </button>
</div>
</div>
</div>
</section>
<section class="py-8 md:py-16 bg-gray-50" id="menu">
<div class="container mx-auto px-4 md:px-6">
<h3 class="text-4xl font-bold text-center text-gray-800 mb-12">Nuestras Pizzas Favoritas</h3>
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8">
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/color/96/000000/pizza.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">Margherita ClÃ¡sica</h4>
<p class="text-gray-600 mb-4">Tomate, mozzarella fresca, albahaca y amor</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$12.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/doodle/96/000000/pizza--v1.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">Pepperoni Suprema</h4>
<p class="text-gray-600 mb-4">Pepperoni, queso extra y especias secretas</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$15.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/emoji/96/000000/pizza-emoji.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">Veggie Deluxe</h4>
<p class="text-gray-600 mb-4">Vegetales frescos, pimientos y champiÃ±ones</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$14.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/color/96/000000/pizza.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">BBQ Chicken</h4>
<p class="text-gray-600 mb-4">Pollo BBQ, cebolla morada, cilantro y salsa especial</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$17.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/doodle/96/000000/pizza--v1.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">Hawaiana Tropical</h4>
<p class="text-gray-600 mb-4">JamÃ³n, piÃ±a fresca, queso mozzarella y un toque de coco</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$16.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-48 flex items-center justify-center">
<div class="text-6xl"><img alt="Pizza" class="w-24 h-24 mx-auto" src="https://img.icons8.com/emoji/96/000000/pizza-emoji.png"/></div>
</div>
<div class="p-6">
<h4 class="text-2xl font-bold text-gray-800 mb-2">Cuatro Quesos</h4>
<p class="text-gray-600 mb-4">Mozzarella, parmesano, gorgonzola y queso de cabra</p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-500">$18.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                Agregar ğŸ›’
                            </button>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="py-8 md:py-16 bg-white">
<div class="container mx-auto px-4 md:px-6">
<h3 class="text-4xl font-bold text-center text-gray-800 mb-12">Complementa tu Pizza</h3>
<div class="mb-16">
<h4 class="text-3xl font-bold text-center text-orange-500 mb-8">ğŸŸ Papas Crujientes</h4>
<div class="flex justify-center">
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale max-w-sm">
<div class="h-40 bg-gradient-to-br from-yellow-400 to-orange-400 flex items-center justify-center">
<div class="text-5xl">ğŸŸ</div>
</div>
<div class="p-6">
<h5 class="text-xl font-bold text-gray-800 mb-2">Papas ClÃ¡sicas</h5>
<p class="text-gray-600 mb-4">Papas doradas y crujientes - Â¡PersonalÃ­zalas!</p>
<div class="flex justify-between items-center">
<span class="text-xl font-bold text-orange-500">$4.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                    Agregar ğŸ›’
                                </button>
</div>
</div>
</div>
</div>
</div>
<div class="mb-16">
<h4 class="text-3xl font-bold text-center text-orange-500 mb-8">ğŸ— Alitas Picantes</h4>
<div class="flex justify-center">
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale max-w-sm">
<div class="h-40 bg-gradient-to-br from-red-400 to-orange-500 flex items-center justify-center">
<div class="text-5xl">ğŸ—</div>
</div>
<div class="p-6">
<h5 class="text-xl font-bold text-gray-800 mb-2">Alitas de Pollo</h5>
<p class="text-gray-600 mb-4">Jugosas alitas con tu sabor favorito - Â¡Elige tamaÃ±o y sabor!</p>
<div class="flex justify-between items-center">
<span class="text-xl font-bold text-orange-500">$8.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                    Agregar ğŸ›’
                                </button>
</div>
</div>
</div>
</div>
</div>
<div class="mb-16">
<h4 class="text-3xl font-bold text-center text-orange-500 mb-8">ğŸ¥– Panes de Ajo</h4>
<div class="flex justify-center">
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale max-w-sm">
<div class="h-40 bg-gradient-to-br from-yellow-300 to-yellow-500 flex items-center justify-center">
<div class="text-5xl">ğŸ¥–</div>
</div>
<div class="p-6">
<h5 class="text-xl font-bold text-gray-800 mb-2">Pan de Ajo Artesanal</h5>
<p class="text-gray-600 mb-4">Pan fresco con mantequilla de ajo - Â¡Elige piezas y tamaÃ±o!</p>
<div class="flex justify-between items-center">
<span class="text-xl font-bold text-orange-500">$3.99 MXN</span>
<button class="bg-orange-500 text-white px-4 py-2 rounded-full hover:bg-orange-600 transition-colors">
                                    Agregar ğŸ›’
                                </button>
</div>
</div>
</div>
</div>
</div>
<div>
<h4 class="text-3xl font-bold text-center text-orange-500 mb-8">ğŸ¥¤ Refrescos Helados</h4>

<div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-32 bg-gradient-to-br from-red-400 to-red-600 flex items-center justify-center">
<div class="text-4xl">ğŸ¥¤</div>
</div>
<div class="p-4">
<h5 class="text-lg font-bold text-gray-800 mb-2">Coca-Cola</h5>
<p class="text-sm text-gray-600 mb-3">ClÃ¡sica y refrescante</p>
<div class="flex justify-between items-center">
<span class="text-lg font-bold text-orange-500">$2.99 MXN</span>
<button class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm hover:bg-orange-600 transition-colors">
                                    + ğŸ›’
                                </button>
</div>
</div>
</div>
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-32 bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center">
<div class="text-4xl">ğŸ¥¤</div>
</div>
<div class="p-4">
<h5 class="text-lg font-bold text-gray-800 mb-2">Fanta Naranja</h5>
<p class="text-sm text-gray-600 mb-3">Sabor cÃ­trico explosivo</p>
<div class="flex justify-between items-center">
<span class="text-lg font-bold text-orange-500">$2.99 MXN</span>
<button class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm hover:bg-orange-600 transition-colors">
                                    + ğŸ›’
                                </button>
</div>
</div>
</div>
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-32 bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center">
<div class="text-4xl">ğŸ¥¤</div>
</div>
<div class="p-4">
<h5 class="text-lg font-bold text-gray-800 mb-2">Sprite</h5>
<p class="text-sm text-gray-600 mb-3">Lima-limÃ³n burbujeante</p>
<div class="flex justify-between items-center">
<span class="text-lg font-bold text-orange-500">$2.99 MXN</span>
<button class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm hover:bg-orange-600 transition-colors">
                                    + ğŸ›’
                                </button>
</div>
</div>
</div>
<div class="bg-gray-50 rounded-2xl shadow-lg overflow-hidden hover-scale">
<div class="h-32 bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center">
<div class="text-4xl">ğŸ’§</div>
</div>
<div class="p-4">
<h5 class="text-lg font-bold text-gray-800 mb-2">Agua Natural</h5>
<p class="text-sm text-gray-600 mb-3">Pura y refrescante</p>
<div class="flex justify-between items-center">
<span class="text-lg font-bold text-orange-500">$1.99 MXN</span>
<button class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm hover:bg-orange-600 transition-colors">
                                    + ğŸ›’
                                </button>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="py-8 md:py-16 bg-white" id="nosotros">
<div class="container mx-auto px-4 md:px-6">
<div class="text-center mb-12">
<h3 class="text-4xl font-bold text-gray-800 mb-6">Nuestra Historia</h3>
<div class="max-w-4xl mx-auto">
<p class="text-lg text-gray-600 mb-6">
                        Todo comenzÃ³ en 2018 cuando Federico, un joven de 22 aÃ±os apasionado por la cocina, decidiÃ³ abandonar sus estudios de ingenierÃ­a para perseguir su sueÃ±o: crear la pizzerÃ­a mÃ¡s cool de la ciudad. ğŸ“â¡ï¸ğŸ•
                    </p>
<p class="text-lg text-gray-600 mb-6">
                        Con solo $500 en el bolsillo y una receta secreta heredada de su abuela italiana, Federico transformÃ³ un pequeÃ±o local abandonado en el corazÃ³n del barrio universitario. Sus amigos lo llamaban loco, pero Ã©l sabÃ­a que tenÃ­a algo especial entre las manos.
                    </p>
<p class="text-lg text-gray-600 mb-8">
                        Hoy, 6 aÃ±os despuÃ©s, Federic's Pizza se ha convertido en el lugar favorito de estudiantes, jÃ³venes profesionales y cualquiera que busque una pizza autÃ©ntica con ese toque rebelde que nos caracteriza. Â¡Somos mÃ¡s que una pizzerÃ­a, somos una comunidad! ğŸ¤˜
                    </p>
</div>
</div>
<div class="grid md:grid-cols-2 gap-12 items-center">
<div>
<h3 class="text-3xl font-bold text-gray-800 mb-6">Â¿Por QuÃ© Federic's?</h3>
<div class="space-y-4">
<div class="flex items-center space-x-4">
<div class="text-3xl">ğŸ”¥</div>
<div>
<h4 class="font-semibold text-lg">Ingredientes Frescos</h4>
<p class="text-gray-600">Seleccionamos los mejores ingredientes cada dÃ­a</p>
</div>
</div>
<div class="flex items-center space-x-4">
<div class="text-3xl">âš¡</div>
<div>
<h4 class="font-semibold text-lg">Entrega RÃ¡pida</h4>
<p class="text-gray-600">Tu pizza caliente en menos de 30 minutos</p>
</div>
</div>
<div class="flex items-center space-x-4">
<div class="text-3xl">ğŸ’</div>
<div>
<h4 class="font-semibold text-lg">Precios Justos</h4>
<p class="text-gray-600">Calidad premium a precios de estudiante</p>
</div>
</div>
</div>
</div>
<div class="text-center">
<div class="text-9xl mb-4">ğŸ•</div>
<p class="text-xl text-gray-600 italic">"La pizza que une a los amigos"</p>
<p class="text-sm text-orange-500 mt-2 font-semibold">- Federico, Fundador</p>
</div>
</div>
</div>
</section>
<section class="gradient-bg py-16" id="contacto">
<div class="container mx-auto px-4 md:px-6 text-center">
<h3 class="text-4xl font-bold text-white mb-8">Â¡ContÃ¡ctanos!</h3>
<div class="grid md:grid-cols-3 gap-8 mb-8">
<div class="bg-white bg-opacity-20 rounded-2xl p-6">
<div class="text-4xl mb-4">ğŸ“±</div>
<h4 class="font-semibold text-white mb-2">TelÃ©fono</h4>
<p class="text-orange-100">+52 (246) 330 9000</p>
</div>
<div class="bg-white bg-opacity-20 rounded-2xl p-6">
<div class="text-4xl mb-4">ğŸ“</div>
<h4 class="font-semibold text-white mb-2">UbicaciÃ³n</h4>
<a class="text-orange-100 hover:text-white transition-colors underline" href="https://maps.app.goo.gl/VRicEsPeYx9MD5ge9?g_st=ipc" rel="noopener noreferrer" target="_blank">
                        123 Pizza Street, Ciudad
                    </a>
</div>
<div class="bg-white bg-opacity-20 rounded-2xl p-6">
<div class="text-4xl mb-4">â°</div>
<h4 class="font-semibold text-white mb-2">Horarios</h4>
<p class="text-orange-100">Lun-Dom: 11AM - 11PM</p>
</div>
</section>
<footer class="bg-gray-800 text-white py-8">
<div class="container mx-auto px-4 md:px-6 text-center">
<div class="flex items-center justify-center space-x-3 mb-4">
<img alt="Federic's Pizza Logo" class="h-10 w-10 rounded-full" src="https://i.imgur.com/EDWicBS.jpeg"/>
<h5 class="text-2xl font-bold">Federic's Pizza</h5>
</div>
<p class="text-gray-400 mb-4">La mejor pizza para la mejor gente joven</p>
<div class="flex justify-center space-x-6">
<a class="text-orange-400 hover:text-orange-300 transition-colors" href="https://www.instagram.com/federics_pizza?igsh=MWVjZnYxanZoNzl4Nw%3D%3D&amp;utm_source=qr" rel="noopener noreferrer" target="_blank">Instagram ğŸ“¸</a>
</div>
<p class="text-gray-500 mt-6">Â© 2024 Federic's Pizza. Todos los derechos reservados.</p>
</div>
</footer>
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="cartModal">
<div class="bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Tu Carrito ğŸ›’</h3>
<p class="text-orange-100">Revisa tus deliciosas selecciones</p>
</div>
<div class="p-6">
<div class="space-y-4 mb-6" id="cartItems">
</div>
<div class="text-center py-8 text-gray-500" id="emptyCart">
<div class="text-6xl mb-4">ğŸ•</div>
<p class="text-lg">Tu carrito estÃ¡ vacÃ­o</p>
<p class="text-sm">Â¡Agrega algunas pizzas deliciosas!</p>
</div>
<div class="border-t pt-4 mb-6 hidden" id="cartSummary">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total del Carrito:</span>
<span class="text-orange-500" id="cartTotal">$0.00 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="closeCart">
                        Seguir Comprando
                    </button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="checkoutCart">
                        Proceder al Pago ğŸ’³
                    </button>
</div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="friesModal">
<div class="bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Personaliza tus Papas</h3>
<div class="text-4xl mb-2">ğŸŸ</div>
<p class="text-lg">Papas ClÃ¡sicas</p>
</div>
<div class="p-6">
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">TamaÃ±o ğŸ“</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="friesSize" type="radio" value="pequeÃ±o"/>
<span>PequeÃ±o - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="friesSize" type="radio" value="mediano"/>
<span>Mediano - +$1.50 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="friesSize" type="radio" value="grande"/>
<span>Grande - +$2.50 MXN</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Extras Deliciosos ğŸ§€</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Queso Cheddar - +$2.00 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Tocino Crujiente - +$2.50 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Sal de Ajo - +$0.50 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Sal de Mar - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Parmesano - +$1.50 MXN</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Cantidad ğŸ”¢</h4>
<div class="flex items-center space-x-4">
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="decreaseFriesQty">-</button>
<span class="text-xl font-semibold" id="friesQuantity">1</span>
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="increaseFriesQty">+</button>
</div>
</div>
<div class="border-t pt-4 mb-6">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total:</span>
<span class="text-orange-500" id="friesTotalPrice">$4.99 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelFriesCustomize">
                        Cancelar
                    </button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="addFriesToCart">
                        Agregar al Carrito ğŸ›’
                    </button>
</div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="drinkModal">
<div class="bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Personaliza tu Refresco</h3>
<div class="text-4xl mb-2">ğŸ¥¤</div>
<p class="text-lg" id="modalDrinkName"></p>
</div>
<div class="p-6">
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">TamaÃ±o ğŸ“</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="drinkSize" type="radio" value="pequeÃ±o"/>
<span>PequeÃ±o (12oz) - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="drinkSize" type="radio" value="mediano"/>
<span>Mediano (16oz) - +$0.50 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="drinkSize" type="radio" value="grande"/>
<span>Grande (20oz) - +$1.00 MXN</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Cantidad de Hielo ğŸ§Š</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="ice" type="radio" value="sin-hielo"/>
<span>Sin Hielo</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="ice" type="radio" value="poco-hielo"/>
<span>Poco Hielo</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="ice" type="radio" value="hielo-normal"/>
<span>Hielo Normal</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="ice" type="radio" value="mucho-hielo"/>
<span>Mucho Hielo</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Cantidad ğŸ”¢</h4>
<div class="flex items-center space-x-4">
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="decreaseDrinkQty">-</button>
<span class="text-xl font-semibold" id="drinkQuantity">1</span>
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="increaseDrinkQty">+</button>
</div>
</div>
<div class="border-t pt-4 mb-6">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total:</span>
<span class="text-orange-500" id="drinkTotalPrice">$2.99 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelDrinkCustomize">
                        Cancelar
                    </button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="addDrinkToCart">
                        Agregar al Carrito ğŸ›’
                    </button>
</div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="wingsModal">
<div class="bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Personaliza tus Alitas</h3>
<div class="text-4xl mb-2">ğŸ—</div>
<p class="text-lg">Alitas de Pollo</p>
</div>
<div class="p-6">
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">TamaÃ±o ğŸ“</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="wingsSize" type="radio" value="pequeÃ±o"/>
<span>PequeÃ±o (6 piezas) - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsSize" type="radio" value="mediano"/>
<span>Mediano (12 piezas) - +$4.00 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsSize" type="radio" value="grande"/>
<span>Grande (18 piezas) - +$8.00 MXN</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Sabor ğŸŒ¶ï¸</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="wingsFlavor" type="radio" value="buffalo"/>
<span>Buffalo ClÃ¡sico - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsFlavor" type="radio" value="bbq"/>
<span>BBQ Ahumado - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsFlavor" type="radio" value="honey-mustard"/>
<span>Miel y Mostaza - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsFlavor" type="radio" value="teriyaki"/>
<span>Teriyaki - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsFlavor" type="radio" value="habanero"/>
<span>Habanero Picante ğŸ”¥ - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="wingsFlavor" type="radio" value="lemon-pepper"/>
<span>LimÃ³n y Pimienta - Incluido</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Cantidad ğŸ”¢</h4>
<div class="flex items-center space-x-4">
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="decreaseWingsQty">-</button>
<span class="text-xl font-semibold" id="wingsQuantity">1</span>
<button class="bg-orange-500 text-white w-10 h-10 rounded-full hover:bg-orange-600 transition-colors" id="increaseWingsQty">+</button>
</div>
</div>
<div class="border-t pt-4 mb-6">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total:</span>
<span class="text-orange-500" id="wingsTotalPrice">$8.99 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelWingsCustomize">
                        Cancelar
                    </button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="addWingsToCart">
                        Agregar al Carrito ğŸ›’
                    </button>
</div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="breadModal">
<div class="bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Personaliza tu Pan de Ajo</h3>
<div class="text-4xl mb-2">ğŸ¥–</div>
<p class="text-lg">Pan de Ajo Artesanal</p>
</div>
<div class="p-6">
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">NÃºmero de Piezas ğŸ”¢</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="breadPieces" type="radio" value="4-piezas"/>
<span>4 Piezas - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="breadPieces" type="radio" value="8-piezas"/>
<span>8 Piezas - +$3.00 MXN</span>
</label>
</div>
</div>
<div class="mb-6">
<h4 class="font-semibold text-lg mb-3 text-gray-800">Complementos Deliciosos ğŸ§€</h4>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Queso Mozzarella Derretido - +$1.50 MXN</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>OrÃ©gano - Incluido</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" type="checkbox"/>
<span>Pepperoni - +$2.00 MXN</span>
</label>
</div>
</div>
<div class="border-t pt-4 mb-6">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total:</span>
<span class="text-orange-500" id="breadTotalPrice">$3.99 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelBreadCustomize">
                        Cancelar
                    </button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="addBreadToCart">
                        Agregar al Carrito ğŸ›’
                    </button>
</div>
</div>
</div>
</div>

<!-- Modal de DirecciÃ³n de Entrega -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4 transition-opacity duration-300" id="deliveryModal">
<div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">DirecciÃ³n de Entrega ğŸšš</h3>
<p class="text-orange-100">Completa los datos para tu entrega</p>
</div>
<form class="p-6 space-y-4" id="deliveryForm">
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" id="calle" placeholder="Nombre de la calle" required="" type="text"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" id="colonia" placeholder="Colonia" required="" type="text"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" id="municipio" placeholder="Municipio" required="" type="text"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" id="numeroInterior" placeholder="NÃºmero interior (opcional)" type="text"/>
<textarea class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" id="descripcion" placeholder="DescripciÃ³n del sitio (por ejemplo, color del portÃ³n, referencia, etc.)"></textarea>
<label class="flex items-center space-x-2">
<input class="text-orange-500" id="guardarDireccion" type="checkbox"/>
<span class="text-gray-700 text-sm">Guardar esta direcciÃ³n para futuras entregas</span>
</label>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelDelivery" type="button">Cancelar</button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" type="submit">Guardar DirecciÃ³n ğŸ’¾</button>
</div>
</form>
</div>
</div>

<!-- ========== NUEVOS MODALES DE PAGO MEJORADOS ========== -->

<!-- Modal de Pago Mejorado -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="paymentModal">
  <div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
    <div class="gradient-bg p-6 text-white text-center">
      <h3 class="text-2xl font-bold mb-2">MÃ©todo de Pago ğŸ’³</h3>
      <p class="text-orange-100">Elige cÃ³mo deseas pagar tu pedido</p>
    </div>
    <div class="p-6 space-y-4">
      <button id="payWithCard" class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors flex items-center justify-center space-x-2">
        <span>ğŸ’³</span>
        <span>Pagar con Tarjeta</span>
      </button>
      <button id="payWithSavedCard" class="w-full border-2 border-orange-500 text-orange-500 py-3 rounded-full font-semibold hover:bg-orange-50 transition-colors flex items-center justify-center space-x-2 hidden">
        <span>ğŸ’³</span>
        <span>Usar Tarjeta Guardada</span>
      </button>
      <button id="payOnDelivery" class="w-full border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center space-x-2">
        <span>ğŸ’µ</span>
        <span>Pagar al Recibir</span>
      </button>
      <button id="cancelPayment" class="w-full text-gray-500 hover:text-gray-700 transition-colors">
        Cancelar
      </button>
    </div>
  </div>
</div>

<!-- Modal de Formulario de Tarjeta Mejorado -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="cardFormModal">
  <div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
    <div class="gradient-bg p-6 text-white text-center">
      <h3 class="text-2xl font-bold mb-2">Pago con Tarjeta ğŸ’³</h3>
      <p class="text-orange-100">Introduce los datos de tu tarjeta</p>
    </div>
    <form class="p-6 space-y-4" id="cardForm">
      <!-- InformaciÃ³n de la tarjeta -->
      <div class="bg-gray-50 p-4 rounded-lg mb-4">
        <div class="flex justify-between items-center mb-2">
          <span class="text-gray-600">Tarjeta</span>
          <div class="flex space-x-2">
            <span class="text-xl">ğŸ’³</span>
            <span class="text-xl">ğŸ”’</span>
          </div>
        </div>
        
        <div class="space-y-3">
          <input type="text" id="cardName" class="w-full border rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="Nombre en la tarjeta" required />
          
          <input type="text" id="cardNumber" maxlength="19" class="w-full border rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="1234 5678 9012 3456" required />
          
          <div class="flex space-x-3">
            <input type="text" id="cardExp" maxlength="5" class="flex-1 border rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="MM/AA" required />
            <input type="text" id="cardCVV" maxlength="3" class="flex-1 border rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="CVV" required />
          </div>
        </div>
      </div>
      
      <!-- OpciÃ³n para guardar tarjeta -->
      <div class="flex items-center space-x-2 mb-4">
        <input type="checkbox" id="saveCard" class="text-orange-500 rounded" checked />
        <label for="saveCard" class="text-gray-700 text-sm">Guardar esta tarjeta para futuras compras</label>
      </div>
      
      <!-- InformaciÃ³n de seguridad -->
      <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
        <p class="text-green-700 text-sm flex items-center justify-center space-x-1">
          <span>ğŸ”’</span>
          <span>Tus datos estÃ¡n protegidos con encriptaciÃ³n SSL</span>
        </p>
      </div>
      
      <div class="flex space-x-3">
        <button type="button" id="cancelCardForm" class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors">
          Cancelar
        </button>
        <button type="submit" class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors flex items-center justify-center space-x-2">
          <span>Confirmar Pago</span>
          <span>âœ…</span>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de ConfirmaciÃ³n de Pago -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="paymentSuccessModal">
  <div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
    <div class="gradient-bg p-6 text-white text-center">
      <h3 class="text-2xl font-bold mb-2">Â¡Pago Exitoso! ğŸ‰</h3>
      <p class="text-orange-100">Tu pedido estÃ¡ en camino</p>
    </div>
    <div class="p-6 text-center">
      <div class="text-6xl mb-4">âœ…</div>
      <p class="text-gray-700 mb-2">Tu pago ha sido procesado correctamente</p>
      <p class="text-gray-500 text-sm mb-6">RecibirÃ¡s una confirmaciÃ³n por correo electrÃ³nico</p>
      <button id="closePaymentSuccess" class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors">
        Continuar
      </button>
    </div>
  </div>
</div>

<!-- ========== FIN NUEVOS MODALES DE PAGO ========== -->

<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4" id="pizzaModal">
<div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2" id="pizzaModalTitle">Personaliza tu Pizza</h3>
<p class="text-orange-100">Elige tamaÃ±o, masa, extras y cantidad</p>
</div>
<form class="p-6 space-y-4" id="pizzaForm">
<div>
<label class="block text-sm font-semibold mb-1">TamaÃ±o</label>
<select class="w-full border rounded-lg px-4 py-2" id="pizzaSize">
<option value="chica">Chica - $120</option>
<option value="mediana">Mediana - $150</option>
<option value="grande">Grande - $180</option>
</select>
</div>
<div>
<label class="block text-sm font-semibold mb-1">Tipo de masa</label>
<div class="space-y-2">
<label class="flex items-center space-x-3 cursor-pointer">
<input checked="" class="text-orange-500" name="pizzaCrust" type="radio" value="tradicional"/>
<span>Tradicional</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="pizzaCrust" type="radio" value="delgada"/>
<span>Delgada y crujiente (+$10)</span>
</label>
<label class="flex items-center space-x-3 cursor-pointer">
<input class="text-orange-500" name="pizzaCrust" type="radio" value="gruesa"/>
<span>Gruesa con queso (+$25)</span>
</label>
</div>
</div>
<div>
<label class="block text-sm font-semibold mb-1">Extras (cada uno suma)</label>
<div class="grid grid-cols-2 gap-2">
<label class="flex items-center space-x-2"><input class="extra-checkbox text-orange-500" type="checkbox" value="queso-extra"/> <span>Queso extra (+$15)</span></label>
<label class="flex items-center space-x-2"><input class="extra-checkbox text-orange-500" type="checkbox" value="pepperoni"/> <span>Pepperoni (+$20)</span></label>
<label class="flex items-center space-x-2"><input class="extra-checkbox text-orange-500" type="checkbox" value="champinones"/> <span>ChampiÃ±ones (+$10)</span></label>
<label class="flex items-center space-x-2"><input class="extra-checkbox text-orange-500" type="checkbox" value="jamon"/> <span>JamÃ³n (+$15)</span></label>
<label class="flex items-center space-x-2"><input class="extra-checkbox text-orange-500" type="checkbox" value="tocino"/> <span>Tocino (+$20)</span></label>
</div>
</div>
<div>
<label class="block text-sm font-semibold mb-1">Cantidad</label>
<div class="flex items-center space-x-4">
<button class="bg-orange-500 text-white w-10 h-10 rounded-full" id="decreasePizzaQty" type="button">-</button>
<span class="text-xl font-semibold" id="pizzaQuantity">1</span>
<button class="bg-orange-500 text-white w-10 h-10 rounded-full" id="increasePizzaQty" type="button">+</button>
</div>
</div>
<div class="border-t pt-4">
<div class="flex justify-between items-center text-xl font-bold">
<span>Total:</span>
<span class="text-orange-500" id="pizzaTotalPrice">$120.00 MXN</span>
</div>
</div>
<div class="flex space-x-3">
<button class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-full font-semibold hover:bg-gray-50 transition-colors" id="cancelPizza" type="button">Cancelar</button>
<button class="flex-1 bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="addPizzaToCart" type="submit">Agregar al Carrito ğŸ›’</button>
</div>
</form>
</div>
</div>

<!-- Modal de Ayuda - VersiÃ³n Mejorada -->
<div class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 flex items-center justify-center p-2 sm:p-4" id="helpModal">
  <div class="bg-white w-full h-full sm:h-5/6 sm:max-w-4xl sm:rounded-2xl overflow-y-auto relative flex flex-col">
    <!-- Header sticky -->
    <div class="gradient-bg text-white p-4 flex justify-between items-center sticky top-0 z-10">
      <h3 class="text-xl sm:text-2xl font-bold">Centro de Ayuda</h3>
      <button id="closeHelpModal" class="text-white text-2xl font-bold hover:text-orange-200 w-8 h-8 flex items-center justify-center">Ã—</button>
    </div>
    
    <!-- Contenido -->
    <div class="flex-1 p-4 sm:p-6 text-gray-800 overflow-y-auto">
      <!-- Hero Section -->
      <section class="gradient-bg py-8 sm:py-12 text-center text-white rounded-2xl mb-6 sm:mb-8">
        <div class="container mx-auto px-4">
          <h2 class="text-2xl sm:text-4xl font-bold mb-4">Centro de Ayuda</h2>
          <p class="text-sm sm:text-lg text-orange-100 max-w-2xl mx-auto mb-4 sm:mb-6">
            Â¿Tienes alguna pregunta? Encuentra respuestas a las consultas mÃ¡s comunes
          </p>
          <div class="relative max-w-xl mx-auto">
            <input id="searchInput" type="text" placeholder="Buscar en el centro de ayuda..." 
                   class="w-full px-4 sm:px-6 py-2 sm:py-3 rounded-full shadow-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-orange-400 text-sm sm:text-base">
            <button onclick="searchContent()" class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-orange-600 text-white px-3 sm:px-4 py-1 rounded-full hover:bg-orange-700 transition text-sm">Buscar</button>
          </div>
        </div>
      </section>

      <!-- Resultados de bÃºsqueda -->
      <div id="resultsContainer" class="mb-6 hidden">
        <h3 class="text-lg sm:text-xl font-semibold text-orange-600 mb-3">Resultados:</h3>
        <ul id="resultsList" class="list-disc pl-5 text-gray-700 space-y-1"></ul>
      </div>

      <!-- Contenido principal -->
      <main class="container mx-auto">
        <div id="helpContent" class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
          <!-- Card 1 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸ• MenÃº y productos</h3>
            <p class="text-gray-600 text-sm sm:text-base mb-2">InformaciÃ³n sobre pizzas, pastas, bebidas y postres</p>
            <p class="text-sm sm:text-base">Ofrecemos una amplia variedad de pizzas artesanales, pastas caseras, bebidas refrescantes y postres deliciosos.</p>
            <p class="mt-2 text-sm sm:text-base"><strong>Opciones vegetarianas, veganas y sin gluten:</strong> Tenemos opciones para todos los gustos.</p>
          </div>

          <!-- Card 2 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸšš Pedidos y entregas</h3>
            <p class="text-sm sm:text-base"><strong>CÃ³mo hacer un pedido:</strong> Web, app o telÃ©fono</p>
            <p class="text-sm sm:text-base"><strong>Tiempos de entrega:</strong> 30-45 min aprox.</p>
            <p class="text-sm sm:text-base"><strong>Cobertura:</strong> Zona centro y colonias cercanas</p>
          </div>

          <!-- Card 3 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸ’³ Pagos y facturaciÃ³n</h3>
            <p class="text-sm sm:text-base"><strong>MÃ©todos aceptados:</strong> Efectivo, tarjetas y apps</p>
            <p class="text-sm sm:text-base"><strong>Factura:</strong> SolicÃ­tala al hacer el pedido</p>
            <p class="text-sm sm:text-base"><strong>Reembolsos:</strong> Dentro de las 2 horas</p>
          </div>

          <!-- Card 4 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸ Promociones y cupones</h3>
            <p class="text-sm sm:text-base"><strong>Usar un cupÃ³n:</strong> Ingresa el cÃ³digo al finalizar</p>
            <p class="text-sm sm:text-base"><strong>Promos especiales:</strong> Martes 2x1, Jueves 30% descuento</p>
          </div>

          <!-- Card 5 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸ”’ Privacidad y seguridad</h3>
            <p class="text-sm sm:text-base"><strong>ProtecciÃ³n de datos:</strong> Cifrado SSL</p>
            <p class="text-sm sm:text-base"><strong>PolÃ­ticas de uso:</strong> Consulta tÃ©rminos en pie de pÃ¡gina</p>
          </div>

          <!-- Card 6 -->
          <div class="card bg-white shadow-md rounded-xl sm:rounded-2xl p-4 sm:p-6 border-l-4 border-orange-500">
            <h3 class="text-lg sm:text-xl font-bold mb-2">ğŸ‘¤ Cuenta y registro</h3>
            <p class="text-sm sm:text-base"><strong>CÃ³mo registrarse:</strong> Crear cuenta y verificar correo</p>
            <p class="text-sm sm:text-base"><strong>Recuperar contraseÃ±a:</strong> Enlace "Â¿Olvidaste tu contraseÃ±a?"</p>
          </div>
        </div>
      </main>
    </div>
  </div>
</div>

<!-- Modal de Cuenta -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4 transition-opacity duration-300" id="accountModal">
<div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95" id="accountModalContent">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Tu Cuenta ğŸ‘¤</h3>
<p class="text-orange-100">Elige una opciÃ³n</p>
</div>
<div class="p-6 text-center space-y-4">
<button class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="openRegister">Crear Cuenta ğŸ“</button>
<button class="w-full border-2 border-orange-500 text-orange-500 py-3 rounded-full font-semibold hover:bg-orange-50 transition-colors" id="openLogin">Iniciar SesiÃ³n ğŸ”</button>
<button class="w-full text-gray-500 mt-4 hover:text-gray-700 transition-colors" id="closeAccountModal">Cancelar</button>
</div>
</div>
</div>
<!-- Modal Crear Cuenta -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4 transition-opacity duration-300" id="registerModal">
<div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Crear Cuenta ğŸ“</h3>
<p class="text-orange-100">Completa tus datos bÃ¡sicos</p>
</div>
<form class="p-6 space-y-4">
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="Nombre" required="" type="text"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="Apellidos" required="" type="text"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="TelÃ©fono" required="" type="tel"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="Correo electrÃ³nico" required="" type="email"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="ContraseÃ±a" required="" type="password"/>
<button class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" type="submit">Registrar</button>
<button class="w-full text-gray-500 hover:text-gray-700 transition-colors" id="closeRegister" type="button">Cancelar</button>
</form>
</div>
</div>
<!-- Modal Iniciar SesiÃ³n -->
<div class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4 transition-opacity duration-300" id="loginModal">
<div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
<div class="gradient-bg p-6 text-white text-center">
<h3 class="text-2xl font-bold mb-2">Iniciar SesiÃ³n ğŸ”</h3>
<p class="text-orange-100">Ingresa tus datos</p>
</div>
<form class="p-6 space-y-4">
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="Correo electrÃ³nico" required="" type="email"/>
<input class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" placeholder="ContraseÃ±a" required="" type="password"/>
<button class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" type="submit">Entrar</button>
<button class="w-full text-gray-500 hover:text-gray-700 transition-colors" id="closeLogin" type="button">Cancelar</button>
</form>
</div>
</div>

<script>
// =============================================
// CÃ“DIGO JAVASCRIPT PRINCIPAL
// =============================================

// === Price tables (MXN) ===
const PRICE = {
  pizzas: {chica:120, mediana:150, grande:180},
  crust: {tradicional:0, delgada:10, gruesa:25},
  pizzaExtras: { 'queso-extra':15, 'pepperoni':20, 'champinones':10, 'jamon':15, 'tocino':20 },
  fries: {pequena:45, mediana:55, grande:65, extras: {'cheddar':10, 'tocino':15, 'sal-ajo':5, 'parmesano':8}},
  wings: {p6:90, p12:130, p18:170, extras: {'ranch':10, 'blue-cheese':15, 'apio':5}},
  bread: {p4:35, p8:50, p12:65, extras: {'mozzarella':10, 'pepperoni':15}},
  drinks: {chico:25, mediano:30, grande:35}
};

// Utility: format MXN
function fmt(n){ return '$' + Number(n).toFixed(2) + ' MXN'; }

// Cart storage
let cart = [];

// Update cart UI
function updateCartUI(){
  const cartItems = document.getElementById('cartItems');
  const cartTotalEl = document.getElementById('cartTotal');
  const cartCountEl = document.getElementById('cartCount');
  const cartSummary = document.getElementById('cartSummary');

  // âœ… ACTUALIZAR CONTADOR MÃ“VIL
const mobileCartCount = document.getElementById('mobileCartCount');
if (mobileCartCount) {
    mobileCartCount.textContent = cart.length;
}
  
  cartItems.innerHTML = '';
  let total = 0;
  cart.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'flex justify-between items-start bg-gray-50 p-3 rounded-lg shadow-sm';
    const left = document.createElement('div');
    left.innerHTML = '<div class="font-semibold text-gray-800">'+item.name+'</div><div class="text-sm text-gray-600">'+item.detail+'</div>';
    const right = document.createElement('div');
    right.className = 'text-right';
    right.innerHTML = '<div class="font-bold text-orange-500">'+fmt(item.total)+'</div><div class="text-sm"><button data-idx="'+idx+'" class="removeItem text-xs text-gray-500 hover:text-red-500">Eliminar</button></div>';
    div.appendChild(left);
    div.appendChild(right);
    cartItems.appendChild(div);
    total += item.total;
  });
  if(cart.length>0){
    cartSummary.classList.remove('hidden');
    document.getElementById('emptyCart').classList.add('hidden');
  } else {
    cartSummary.classList.add('hidden');
    document.getElementById('emptyCart').classList.remove('hidden');
  }
  cartTotalEl.textContent = fmt(total);
  cartCountEl.textContent = cart.length;
  // attach remove handlers
  document.querySelectorAll('.removeItem').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const i = Number(e.target.getAttribute('data-idx'));
      cart.splice(i,1);
      updateCartUI();
    });
  });
}

// Generic function to open modal
function openModal(id){
  const modal = document.getElementById(id);
  modal.classList.remove('hidden');
  setTimeout(()=>{
    const inner = modal.querySelector('div > div') || modal.querySelector('div');
    if(inner) inner.classList.replace('scale-95','scale-100');
  }, 10);
}

// Generic to close modal
function closeModal(id){
  const modal = document.getElementById(id);
  if(modal) modal.classList.add('hidden');
}

// === Pizza modal logic ===
let currentPizzaName = '';
document.getElementById('pizzaModal') && (function(){
  const pizzaModal = document.getElementById('pizzaModal');
  const title = document.getElementById('pizzaModalTitle');
  const sizeSel = document.getElementById('pizzaSize');
  const crustRadios = document.getElementsByName('pizzaCrust');
  const extrasChecks = document.querySelectorAll('.extra-checkbox');
  const qtyEl = document.getElementById('pizzaQuantity');
  let qty = 1;
  const priceEl = document.getElementById('pizzaTotalPrice');

  function calcPizzaTotal(){
    const size = sizeSel.value;
    let base = PRICE.pizzas[size];
    // crust
    let crust = Array.from(crustRadios).find(r=>r.checked).value;
    base += PRICE.crust[crust] || 0;
    // extras
    let extraSum = 0;
    extrasChecks.forEach(ch => { if(ch.checked){ extraSum += PRICE.pizzaExtras[ch.value] || 0; }});
    const total = (base + extraSum) * qty;
    priceEl.textContent = fmt(total);
    return total;
  }

  document.getElementById('increasePizzaQty').addEventListener('click', ()=>{ qty++; qtyEl.textContent = qty; calcPizzaTotal(); });
  document.getElementById('decreasePizzaQty').addEventListener('click', ()=>{ if(qty>1) qty--; qtyEl.textContent = qty; calcPizzaTotal(); });
  sizeSel.addEventListener('change', calcPizzaTotal);
  crustRadios.forEach(r => r.addEventListener('change', calcPizzaTotal));
  extrasChecks.forEach(c => c.addEventListener('change', calcPizzaTotal));

  document.getElementById('cancelPizza').addEventListener('click', ()=> closeModal('pizzaModal'));

  // When pizza form submitted -> add to cart
  document.getElementById('pizzaForm').addEventListener('submit', (e)=>{
    e.preventDefault();
    const size = sizeSel.value;
    const crust = Array.from(crustRadios).find(r=>r.checked).value;
    const extras = Array.from(extrasChecks).filter(c=>c.checked).map(c=>c.nextSibling ? c.nextSibling.textContent.trim() : c.value);
    const total = calcPizzaTotal();
    const detail = 'TamaÃ±o: ' + size + ' | Masa: ' + crust + (extras.length?(' | Extras: '+extras.join(', ')):'') + ' | Cantidad: '+qty;
    cart.push({ name: currentPizzaName || 'Pizza', detail, total });
    updateCartUI();
    closeModal('pizzaModal');
  });

  // expose function to open pizza modal with name
  window.openPizzaModal = function(name){
    currentPizzaName = name;
    title.textContent = 'Personaliza: ' + name;
    qty = 1; qtyEl.textContent = qty;
    // reset choices
    sizeSel.value = 'chica';
    crustRadios[0].checked = true;
    extrasChecks.forEach(c=> c.checked = false);
    calcPizzaTotal();
    openModal('pizzaModal');
  };
})();

// === Fries modal logic ===
(function(){
  const friesModal = document.getElementById('friesModal');
  if(!friesModal) return;
  const qtyEl = document.getElementById('friesQuantity');
  let qty = Number(qtyEl.textContent || '1');
  const dec = document.getElementById('decreaseFriesQty');
  const inc = document.getElementById('increaseFriesQty');
  const extras = Array.from(friesModal.querySelectorAll('input[type=checkbox]'));
  // add data-value attributes mapping to our extras keys if missing
  // we will consider text content to map to keys
  function mapExtraCheckbox(ch){
    const txt = ch.nextSibling ? ch.nextSibling.textContent.toLowerCase() : '';
    if(txt.includes('cheddar')) ch.dataset.key='cheddar';
    if(txt.includes('tocino')) ch.dataset.key='tocino';
    if(txt.includes('sal de ajo')||txt.includes('sal de ajo')) ch.dataset.key='sal-ajo';
    if(txt.includes('parmesano')) ch.dataset.key='parmesano';
  }
  extras.forEach(mapExtraCheckbox);

  const totalEl = document.getElementById('friesTotalPrice');
  function calcFries(){
    // size radio: name friesSize
    const size = document.querySelector('input[name="friesSize"]:checked').value;
    let baseKey = size; // pequeÃ±o mediano grande in file: values are pequeÃ±o, mediano, grande
    let base = PRICE.fries.pequena;
    if(baseKey.includes('mediano')) base = PRICE.fries.mediana;
    if(baseKey.includes('grande')) base = PRICE.fries.grande;
    let extraSum = 0;
    extras.forEach(ch => { if(ch.checked && ch.dataset.key) extraSum += PRICE.fries.extras[ch.dataset.key] || 0; });
    const total = (base + extraSum) * qty;
    totalEl.textContent = fmt(total);
    return total;
  }
  inc.addEventListener('click', ()=>{ qty++; qtyEl.textContent = qty; calcFries(); });
  dec.addEventListener('click', ()=>{ if(qty>1) qty--; qtyEl.textContent = qty; calcFries(); });
  document.querySelectorAll('input[name="friesSize"]').forEach(r=> r.addEventListener('change', calcFries));
  extras.forEach(ch=> ch.addEventListener('change', calcFries));
  // add to cart
  document.getElementById('addFriesToCart').addEventListener('click', ()=>{
    const size = document.querySelector('input[name="friesSize"]:checked').value;
    const chosenExtras = extras.filter(c=>c.checked).map(c=> c.nextSibling ? c.nextSibling.textContent.trim() : c.value);
    const total = calcFries();
    const detail = 'TamaÃ±o: '+size+' | Extras: '+(chosenExtras.length?chosenExtras.join(', '):'Ninguno')+' | Cantidad: '+qty;
    cart.push({ name: 'Papas Crujientes', detail, total });
    updateCartUI();
    closeModal('friesModal');
  });
})();

// === Drink modal logic ===
(function(){
  const drinkModal = document.getElementById('drinkModal');
  if(!drinkModal) return;
  const qtyEl = document.getElementById('drinkQuantity');
  let qty = Number(qtyEl.textContent || '1');
  document.getElementById('increaseDrinkQty').addEventListener('click', ()=>{ qty++; qtyEl.textContent = qty; calcDrink(); });
  document.getElementById('decreaseDrinkQty').addEventListener('click', ()=>{ if(qty>1) qty--; qtyEl.textContent = qty; calcDrink(); });
  const totalEl = document.getElementById('drinkTotalPrice');
  function calcDrink(){
    const size = document.querySelector('input[name="drinkSize"]:checked').value;
    let base = PRICE.drinks.chico;
    if(size==='mediano') base = PRICE.drinks.mediano;
    if(size==='grande') base = PRICE.drinks.grande;
    // no price for ice options
    const total = base * qty;
    totalEl.textContent = fmt(total);
    return total;
  }
  document.querySelectorAll('input[name="drinkSize"]').forEach(r=> r.addEventListener('change', calcDrink));
  document.querySelectorAll('input[name="ice"]').forEach(r=> r.addEventListener('change', ()=>{}));
  document.getElementById('addDrinkToCart').addEventListener('click', ()=>{
    const size = document.querySelector('input[name="drinkSize"]:checked').value;
    const ice = document.querySelector('input[name="ice"]:checked').value;
    const total = calcDrink();
    const detail = 'TamaÃ±o: '+size+' | Hielo: '+ice+' | Cantidad: '+qty;
    cart.push({ name: 'Refresco', detail, total });
    updateCartUI();
    closeModal('drinkModal');
  });
  // initial calc
  calcDrink();
})();

// === Wings modal logic ===
(function(){
  const wModal = document.getElementById('wingsModal');
  if(!wModal) return;
  const qtyEl = document.getElementById('wingsQuantity');
  let qty = Number(qtyEl.textContent || '1');
  document.getElementById('increaseWingsQty').addEventListener('click', ()=>{ qty++; qtyEl.textContent = qty; calcWings(); });
  document.getElementById('decreaseWingsQty').addEventListener('click', ()=>{ if(qty>1) qty--; qtyEl.textContent = qty; calcWings(); });
  const totalEl = document.getElementById('wingsTotalPrice');
  function calcWings(){
    const size = document.querySelector('input[name="wingsSize"]:checked').value;
    let base = PRICE.wings.p6;
    if(size.includes('mediano')||size.includes('12')) base = PRICE.wings.p12;
    if(size.includes('grande')||size.includes('18')) base = PRICE.wings.p18;
    // extras
    const extras = Array.from(wModal.querySelectorAll('input[type=checkbox]')).filter(c=>c.checked).map(c=> c.value);
    let extraSum = 0;
    extras.forEach(k => { if(PRICE.wings.extras[k]) extraSum += PRICE.wings.extras[k]; });
    const total = (base + extraSum) * qty;
    totalEl.textContent = fmt(total);
    return total;
  }
  document.querySelectorAll('input[name="wingsSize"]').forEach(r=> r.addEventListener('change', calcWings));
  document.querySelectorAll('input[name="wingsFlavor"]').forEach(r=> r.addEventListener('change', calcWings));
  Array.from(wModal.querySelectorAll('input[type=checkbox]')).forEach(c=> c.addEventListener('change', calcWings));
  document.getElementById('addWingsToCart').addEventListener('click', ()=>{
    const size = document.querySelector('input[name="wingsSize"]:checked').value;
    const flavor = document.querySelector('input[name="wingsFlavor"]:checked').value;
    const extras = Array.from(wModal.querySelectorAll('input[type=checkbox]')).filter(c=>c.checked).map(c=> c.nextSibling ? c.nextSibling.textContent.trim() : c.value);
    const total = calcWings();
    const detail = 'TamaÃ±o: '+size+' | Sabor: '+flavor+' | Extras: '+(extras.length?extras.join(', '):'Ninguno')+' | Cantidad: '+qty;
    cart.push({ name: 'Alitas', detail, total });
    updateCartUI();
    closeModal('wingsModal');
  });
})();

// === Bread modal logic ===
(function(){
  const bModal = document.getElementById('breadModal');
  if(!bModal) return;
  const totalEl = document.getElementById('breadTotalPrice');
  const qtyRadios = document.getElementsByName('breadPieces');
  function calcBread(){
    const pieces = Array.from(qtyRadios).find(r=>r.checked).value;
    let base = PRICE.bread.p4;
    if(pieces.includes('8')) base = PRICE.bread.p8;
    if(pieces.includes('12')) base = PRICE.bread.p12;
    let extraSum = 0;
    Array.from(bModal.querySelectorAll('input[type=checkbox]')).forEach(ch=> { if(ch.checked){ const txt = ch.nextSibling ? ch.nextSibling.textContent.toLowerCase() : ''; if(txt.includes('mozzarella')) extraSum += PRICE.bread.extras['mozzarella']; if(txt.includes('pepperoni')) extraSum += PRICE.bread.extras['pepperoni']; }});
    const total = base + extraSum;
    totalEl.textContent = fmt(total);
    return total;
  }
  Array.from(qtyRadios).forEach(r=> r.addEventListener('change', calcBread));
  Array.from(bModal.querySelectorAll('input[type=checkbox]')).forEach(c=> c.addEventListener('change', calcBread));
  document.getElementById('addBreadToCart').addEventListener('click', ()=>{
    const pieces = Array.from(qtyRadios).find(r=>r.checked).value;
    const extras = Array.from(bModal.querySelectorAll('input[type=checkbox]')).filter(c=>c.checked).map(c=> c.nextSibling ? c.nextSibling.textContent.trim() : c.value);
    const total = calcBread();
    const detail = 'Piezas: '+pieces+' | Extras: '+(extras.length?extras.join(', '):'Ninguno');
    cart.push({ name: 'Pan de Ajo', detail, total });
    updateCartUI();
    closeModal('breadModal');
  });
  calcBread();
})();

// === Hook product "Agregar" buttons to open proper modal ===
(function(){
  // find product cards with buttons that have text 'Agregar' and attach
  document.querySelectorAll('button').forEach(btn => {
    // Skip buttons that are inside modals (ids ending with 'Modal')
    if (btn.closest && btn.closest('[id$="Modal"]')) return;
    if(btn.textContent && btn.textContent.includes('Agregar')){
      btn.addEventListener('click', (e)=>{
        // find nearest product title
        let node = e.target;
        while(node && node !== document.body){
          // look for h4 or h5 within this node
          const h4 = node.querySelector && (node.querySelector('h4') || node.querySelector('h5') || node.querySelector('h3'));
          if(h4){
            const name = h4.textContent.trim();
            // decide category by section or name keywords
            const lower = name.toLowerCase();
            if(lower.includes('papa') || lower.includes('papas')) {
              openModal('friesModal');
              return;
            }
            if(lower.includes('alitas') || lower.includes('alita')) {
              // optionally set modal state
              openModal('wingsModal');
              return;
            }
            if(lower.includes('pan') || lower.includes('ajo')) {
              openModal('breadModal');
              return;
            }
            if(lower.includes('refresco') || lower.includes('coca') || lower.includes('sprite') || lower.includes('fanta') || lower.includes('agua')) {
              openModal('drinkModal');
              return;
            }
            // otherwise treat as pizza
            window.openPizzaModal(name);
            return;
          }
          node = node.parentNode;
        }
        // fallback: pizza modal
        window.openPizzaModal('Pizza');
      });
    }
  });
})();

// initialize cart UI if any saved (no persistence currently)
updateCartUI();

// === CONEXIÃ“N CON EL BACKEND - SISTEMA SIMPLIFICADO ===
const BACKEND_URL = 'https://federics-backend.onrender.com';

// Estado global del usuario
let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

// === SISTEMA DE PAGO MEJORADO - CONEXIÃ“N CON BACKEND ===

// FunciÃ³n para abrir modal de pago
function openPaymentModal() {
  // Verificar si hay productos en el carrito
  if (cart.length === 0) {
    alert('ğŸ›’ Tu carrito estÃ¡ vacÃ­o. Agrega productos antes de proceder al pago.');
    return;
  }
  
  const paymentModal = document.getElementById('paymentModal');
  paymentModal.classList.remove('hidden');
  
  // Verificar si el usuario tiene tarjetas guardadas
  checkSavedCards();
  
  setTimeout(() => {
    const inner = paymentModal.querySelector('div');
    if (inner) inner.classList.replace('scale-95', 'scale-100');
  }, 10);
}

// FunciÃ³n para verificar tarjetas guardadas
async function checkSavedCards() {
  if (!currentUser) return;
  
  try {
    const response = await fetch(`${BACKEND_URL}/api/payments/cards`, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${currentUser.token}`
      }
    });
    
    if (response.ok) {
      const cards = await response.json();
      const savedCardBtn = document.getElementById('payWithSavedCard');
      
      if (cards.length > 0) {
        savedCardBtn.classList.remove('hidden');
        // Guardar la primera tarjeta para uso rÃ¡pido
        localStorage.setItem('savedCard', JSON.stringify(cards[0]));
      } else {
        savedCardBtn.classList.add('hidden');
      }
    }
  } catch (error) {
    console.error('Error al verificar tarjetas guardadas:', error);
  }
}

// FunciÃ³n para formatear nÃºmero de tarjeta
function formatCardNumber(input) {
  // Eliminar todos los espacios existentes
  let value = input.value.replace(/\s+/g, '');
  
  // Agregar espacio cada 4 dÃ­gitos
  value = value.replace(/(\d{4})/g, '$1 ').trim();
  
  // Actualizar el valor del input
  input.value = value;
}

// FunciÃ³n para formatear fecha de expiraciÃ³n
function formatExpiryDate(input) {
  let value = input.value.replace(/\D/g, '');
  
  if (value.length >= 2) {
    value = value.substring(0, 2) + '/' + value.substring(2, 4);
  }
  
  input.value = value;
}

// Event listeners para el sistema de pago
document.addEventListener('DOMContentLoaded', function() {
  // Abrir modal de pago al hacer clic en "Proceder al Pago"
  document.getElementById('checkoutCart').addEventListener('click', openPaymentModal);
  
  // Formatear nÃºmero de tarjeta en tiempo real
  const cardNumberInput = document.getElementById('cardNumber');
  if (cardNumberInput) {
    cardNumberInput.addEventListener('input', function() {
      formatCardNumber(this);
    });
  }
  
  // Formatear fecha de expiraciÃ³n en tiempo real
  const cardExpInput = document.getElementById('cardExp');
  if (cardExpInput) {
    cardExpInput.addEventListener('input', function() {
      formatExpiryDate(this);
    });
  }
  
  // Botones del modal de pago
  document.getElementById('cancelPayment').addEventListener('click', () => {
    document.getElementById('paymentModal').classList.add('hidden');
  });
  
  // Pagar con tarjeta nueva
  document.getElementById('payWithCard').addEventListener('click', () => {
    document.getElementById('paymentModal').classList.add('hidden');
    openCardForm();
  });
  
  // Pagar con tarjeta guardada
  document.getElementById('payWithSavedCard').addEventListener('click', () => {
    payWithSavedCard();
  });
  
  // Pagar al recibir
  document.getElementById('payOnDelivery').addEventListener('click', () => {
    processCashPayment();
  });
  
  // Cancelar formulario de tarjeta
  document.getElementById('cancelCardForm').addEventListener('click', () => {
    document.getElementById('cardFormModal').classList.add('hidden');
  });
  
  // Cerrar modal de Ã©xito
  document.getElementById('closePaymentSuccess').addEventListener('click', () => {
    document.getElementById('paymentSuccessModal').classList.add('hidden');
    document.getElementById('cartModal').classList.add('hidden');
  });
  
  // EnvÃ­o del formulario de tarjeta
  const cardForm = document.getElementById('cardForm');
  if (cardForm) {
    cardForm.addEventListener('submit', processCardPayment);
  }
});

// FunciÃ³n para abrir formulario de tarjeta
function openCardForm() {
  const cardFormModal = document.getElementById('cardFormModal');
  cardFormModal.classList.remove('hidden');
  
  // Limpiar formulario
  document.getElementById('cardForm').reset();
  
  setTimeout(() => {
    const inner = cardFormModal.querySelector('div');
    if (inner) inner.classList.replace('scale-95', 'scale-100');
  }, 10);
}

// FunciÃ³n para procesar pago con tarjeta guardada
async function payWithSavedCard() {
  if (!currentUser) {
    alert('âŒ Debes iniciar sesiÃ³n para usar una tarjeta guardada');
    return;
  }
  
  const savedCard = JSON.parse(localStorage.getItem('savedCard'));
  if (!savedCard) {
    alert('âŒ No tienes tarjetas guardadas');
    return;
  }
  
  // Confirmar uso de tarjeta guardada
  const confirmMessage = `Â¿Usar tarjeta terminada en ${savedCard.last4}?`;
  if (!confirm(confirmMessage)) return;
  
  try {
    // Procesar pago con tarjeta guardada
    const paymentData = {
      cardId: savedCard.id,
      amount: calculateCartTotal(),
      items: cart
    };
    
    const response = await fetch(`${BACKEND_URL}/api/payments/process`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${currentUser.token}`
      },
      body: JSON.stringify(paymentData)
    });
    
    if (response.ok) {
      showPaymentSuccess();
    } else {
      const error = await response.json();
      alert(`âŒ Error en el pago: ${error.message}`);
    }
  } catch (error) {
    alert('âŒ Error de conexiÃ³n al procesar el pago');
    console.error('Error:', error);
  }
}

// FunciÃ³n para procesar pago con nueva tarjeta
// âœ… FUNCIÃ“N MEJORADA PARA PROCESAR PAGO CON NUEVA TARJETA
// âœ… FUNCIÃ“N COMPLETAMENTE CORREGIDA - REEMPLAZA LA ACTUAL
async function processCardPayment(e) {
    e.preventDefault();
    
    console.log('ğŸ” Iniciando proceso de pago...');
    
    if (!currentUser) {
        alert('âŒ Debes iniciar sesiÃ³n para realizar un pago');
        return;
    }
    
    if (!checkToken()) return;

    // âœ… OBTENER DATOS DEL FORMULARIO CORRECTAMENTE
    const cardData = {
        cardHolder: document.getElementById('cardName').value.trim(),
        cardNumber: document.getElementById('cardNumber').value.replace(/\s/g, ''),
        expiryDate: document.getElementById('cardExp').value.trim(),
        cvv: document.getElementById('cardCVV').value.trim()
    };

    // âœ… VERIFICAR CHECKBOX DE FORMA ROBUSTA
    const saveCardCheckbox = document.getElementById('saveCard');
    const saveCard = saveCardCheckbox ? saveCardCheckbox.checked : false;
    
    console.log('ğŸ’¾ Estado de saveCard:', saveCard);
    console.log('ğŸ“¤ Datos de tarjeta:', {
        cardHolder: cardData.cardHolder,
        cardNumber: '***' + cardData.cardNumber.slice(-4),
        expiryDate: cardData.expiryDate,
        saveCard: saveCard
    });
  
    // âœ… VALIDACIONES MEJORADAS
    if (!validateCardData(cardData)) return;
    
    try {
        // âœ… PREPARAR DATOS PARA EL BACKEND
        const paymentData = {
            cardData: cardData,
            amount: calculateCartTotal(),
            items: cart,
            saveCard: saveCard  // âœ… ENVIAR CORRECTAMENTE
        };
        
        console.log('ğŸ“¤ Enviando pago al backend...', {
            amount: paymentData.amount,
            saveCard: paymentData.saveCard,
            itemsCount: paymentData.items.length
        });
        
        const response = await fetch(`${BACKEND_URL}/api/payments/process`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${currentUser.token}`
            },
            body: JSON.stringify(paymentData)
        });
        
        const result = await response.json();
        
        console.log('ğŸ“¥ Respuesta del backend:', result);
        
        if (response.ok) {
            // âœ… ACTUALIZAR TARJETAS GUARDADAS SI SE GUARDÃ“ UNA NUEVA
            if (saveCard && result.cardSaved) {
                console.log('âœ… Tarjeta guardada exitosamente:', result.savedCard);
                // Forzar actualizaciÃ³n de tarjetas guardadas
                setTimeout(checkSavedCards, 1000);
            }
            
            showPaymentSuccess();
        } else {
            // âœ… MANEJO MEJORADO DE ERRORES
            if (result.code === 'TOKEN_EXPIRED') {
                logout();
                alert('Tu sesiÃ³n ha expirado. Por favor, inicia sesiÃ³n nuevamente.');
                document.getElementById('loginModal').classList.remove('hidden');
                return;
            }
            alert(`âŒ Error en el pago: ${result.message}`);
        }
    } catch (error) {
        console.error('ğŸ’¥ Error en processCardPayment:', error);
        alert('âŒ Error de conexiÃ³n al procesar el pago');
    }
}

// âœ… FUNCIÃ“N DE VALIDACIÃ“N MEJORADA
function validateCardData(cardData) {
    // Validar nombre
    if (!cardData.cardHolder || cardData.cardHolder.length < 3) {
        alert('âŒ El nombre en la tarjeta debe tener al menos 3 caracteres');
        return false;
    }
    
    // Validar nÃºmero de tarjeta (sin espacios)
    const cleanCardNumber = cardData.cardNumber.replace(/\D/g, '');
    if (cleanCardNumber.length !== 16) {
        alert('âŒ El nÃºmero de tarjeta debe tener 16 dÃ­gitos');
        return false;
    }
    
    // Validar fecha de expiraciÃ³n
    if (!cardData.expiryDate.match(/^\d{2}\/\d{2}$/)) {
        alert('âŒ Formato de fecha invÃ¡lido (MM/AA)');
        return false;
    }
    
    // Validar CVV
    if (!cardData.cvv || cardData.cvv.length !== 3) {
        alert('âŒ El CVV debe tener 3 dÃ­gitos');
        return false;
    }
    
    return true;
}

// FunciÃ³n para calcular total del carrito
function calculateCartTotal() {
  return cart.reduce((total, item) => total + item.total, 0);
}

// FunciÃ³n para mostrar Ã©xito de pago
function showPaymentSuccess() {
  // Cerrar modales anteriores
  document.getElementById('cardFormModal').classList.add('hidden');
  document.getElementById('paymentModal').classList.add('hidden');
  
  // Mostrar modal de Ã©xito
  const successModal = document.getElementById('paymentSuccessModal');
  successModal.classList.remove('hidden');
  
  setTimeout(() => {
    const inner = successModal.querySelector('div');
    if (inner) inner.classList.replace('scale-95', 'scale-100');
  }, 10);
  
  // Limpiar carrito
  cart = [];
  updateCartUI();
  
  // Generar nÃºmero de pedido
  const orderNumber = 'PZ' + Date.now().toString().slice(-6);
  localStorage.setItem('lastOrder', orderNumber);
}

// Cerrar modales al hacer clic fuera
['paymentModal', 'cardFormModal', 'paymentSuccessModal'].forEach(id => {
  const modal = document.getElementById(id);
  if (modal) {
    modal.addEventListener('click', e => {
      if (e.target.id === id) {
        modal.classList.add('hidden');
      }
    });
  }
});

// Actualizar UI segÃºn estado de login
function updateAuthUI() {
    const accountButton = document.getElementById('accountButton');
    const accountModal = document.getElementById('accountModal');
    
    if (currentUser) {
        // Usuario logueado - mostrar nombre
        accountButton.innerHTML = `ğŸ‘‹ ${currentUser.nombre}`;
        
        // Modificar el modal de cuenta para usuario logueado
        accountModal.innerHTML = `
            <div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
                <div class="gradient-bg p-6 text-white text-center">
                    <h3 class="text-2xl font-bold mb-2">Â¡Hola ${currentUser.nombre}! ğŸ‘‹</h3>
                    <p class="text-orange-100">Bienvenido a Federic's Pizza</p>
                </div>
                <div class="p-6 text-center space-y-4">
                    <div class="text-left bg-gray-50 p-4 rounded-lg">
                        <p><strong>Nombre:</strong> ${currentUser.nombre} ${currentUser.apellidos}</p>
                        <p><strong>Email:</strong> ${currentUser.email}</p>
                        <p><strong>TelÃ©fono:</strong> ${currentUser.telefono}</p>
                    </div>
                    <button class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="viewOrders">Mis Pedidos ğŸ“‹</button>
                    <button class="w-full border-2 border-orange-500 text-orange-500 py-3 rounded-full font-semibold hover:bg-orange-50 transition-colors" id="logoutButton">Cerrar SesiÃ³n ğŸšª</button>
                    <button class="w-full text-gray-500 mt-4 hover:text-gray-700 transition-colors" id="closeAccountModal">Cerrar</button>
                </div>
            </div>
        `;
        
        // Re-asignar event listeners para el nuevo modal
        document.getElementById('logoutButton').addEventListener('click', logout);
        document.getElementById('closeAccountModal').addEventListener('click', () => {
            document.getElementById('accountModal').classList.add('hidden');
        });
        
    } else {
        // Usuario no logueado - mostrar opciones normales
        accountButton.textContent = 'Cuenta';
    }
}

// FunciÃ³n para cerrar sesiÃ³n
function logout() {
  localStorage.removeItem('currentUser');
  localStorage.removeItem('savedCard');
  localStorage.removeItem('direccionEntrega');
  currentUser = null;
  updateAuthUI();
  document.getElementById('accountModal').classList.add('hidden');
  console.log('âœ… SesiÃ³n cerrada correctamente');
}

// âœ… NUEVA FUNCIÃ“N: Verificar si el token estÃ¡ expirado
function isTokenExpired() {
  if (!currentUser || !currentUser.token) return true;
  
  try {
    const payload = JSON.parse(atob(currentUser.token.split('.')[1]));
    const exp = payload.exp * 1000; // Convertir a milisegundos
    return Date.now() >= exp;
  } catch (error) {
    return true;
  }
}

// âœ… NUEVA FUNCIÃ“N: Verificar el token y redirigir si estÃ¡ expirado
function checkToken() {
  if (isTokenExpired()) {
    console.log('ğŸ” Token expirado, redirigiendo a login...');
    logout();
    alert('Tu sesiÃ³n ha expirado. Por favor, inicia sesiÃ³n nuevamente.');
    document.getElementById('loginModal').classList.remove('hidden');
    return false;
  }
  return true;
}

// REGISTRO DE USUARIO
document.querySelector('#registerModal form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const userData = {
        nombre: document.querySelector('#registerModal input[placeholder="Nombre"]').value,
        apellidos: document.querySelector('#registerModal input[placeholder="Apellidos"]').value,
        telefono: document.querySelector('#registerModal input[placeholder="TelÃ©fono"]').value,
        email: document.querySelector('#registerModal input[placeholder="Correo electrÃ³nico"]').value,
        password: document.querySelector('#registerModal input[placeholder="ContraseÃ±a"]').value
    };

    try {
        const response = await fetch(`${BACKEND_URL}/api/auth/register`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(userData)
        });

        const result = await response.json();
        
        if (response.ok) {
            alert('âœ… Cuenta creada exitosamente.');
            document.getElementById('registerModal').classList.add('hidden');
            document.querySelector('#registerModal form').reset();
        } else {
            alert(`âŒ Error: ${result.message || 'No se pudo crear la cuenta'}`);
        }
    } catch (error) {
        alert('âŒ Error de conexiÃ³n con el servidor');
        console.error('Error:', error);
    }
});

// LOGIN DIRECTO (SIN CÃ“DIGO DE VERIFICACIÃ“N)
document.querySelector('#loginModal form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const loginData = {
        email: document.querySelector('#loginModal input[placeholder="Correo electrÃ³nico"]').value,
        password: document.querySelector('#loginModal input[placeholder="ContraseÃ±a"]').value
    };

    try {
        const response = await fetch(`${BACKEND_URL}/api/auth/login`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(loginData)
        });

        const result = await response.json();
        
        if (response.ok) {
            // âœ… GUARDAR USUARIO Y TOKEN DIRECTAMENTE
            currentUser = result.user;
            currentUser.token = result.token;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            alert('âœ… ' + result.message);
            document.getElementById('loginModal').classList.add('hidden');
            document.querySelector('#loginModal form').reset();
            
            // Actualizar UI
            updateAuthUI();
        } else {
            alert(`âŒ Error: ${result.message || 'Credenciales incorrectas'}`);
        }
    } catch (error) {
        alert('âŒ Error de conexiÃ³n con el servidor');
        console.error('Error:', error);
    }
});

// Inicializar UI al cargar la pÃ¡gina
// âœ… FUNCIÃ“N ACTUALIZADA - REEMPLAZA LA EXISTENTE
function updateAuthUI() {
    const accountButton = document.getElementById('accountButton');
    const accountModal = document.getElementById('accountModal');
    
    if (currentUser) {
        // Usuario logueado - mostrar nombre
        accountButton.innerHTML = `ğŸ‘‹ ${currentUser.nombre}`;
        
        // Modificar el modal de cuenta para usuario logueado
        accountModal.innerHTML = `
            <div class="bg-white rounded-2xl max-w-md w-full overflow-hidden transform transition-all duration-500 scale-95">
                <div class="gradient-bg p-6 text-white text-center">
                    <h3 class="text-2xl font-bold mb-2">Â¡Hola ${currentUser.nombre}! ğŸ‘‹</h3>
                    <p class="text-orange-100">Bienvenido a Federic's Pizza</p>
                </div>
                <div class="p-6 text-center space-y-4">
                    <div class="text-left bg-gray-50 p-4 rounded-lg">
                        <p><strong>Nombre:</strong> ${currentUser.nombre} ${currentUser.apellidos}</p>
                        <p><strong>Email:</strong> ${currentUser.email}</p>
                        <p><strong>TelÃ©fono:</strong> ${currentUser.telefono}</p>
                    </div>
                    <button class="w-full bg-orange-500 text-white py-3 rounded-full font-semibold hover:bg-orange-600 transition-colors" id="viewOrders">Mis Pedidos ğŸ“‹</button>
                    <button class="w-full border-2 border-orange-500 text-orange-500 py-3 rounded-full font-semibold hover:bg-orange-50 transition-colors" id="logoutButton">Cerrar SesiÃ³n ğŸšª</button>
                    <button class="w-full text-gray-500 mt-4 hover:text-gray-700 transition-colors" id="closeAccountModal">Cerrar</button>
                </div>
            </div>
        `;
        
        // Re-asignar event listeners para el nuevo modal
        document.getElementById('logoutButton').addEventListener('click', logout);
        document.getElementById('closeAccountModal').addEventListener('click', () => {
            document.getElementById('accountModal').classList.add('hidden');
        });
        
        // âœ… VERIFICAR TARJETAS GUARDADAS DESPUÃ‰S DEL LOGIN
        setTimeout(checkSavedCards, 1000); // PequeÃ±o delay para asegurar
        
    } else {
        // Usuario no logueado - mostrar opciones normales
        accountButton.textContent = 'Cuenta';
    }
}

// âœ… NUEVA FUNCIÃ“N - AÃ‘ADE ESTA DESPUÃ‰S DE updateAuthUI()
// âœ… FUNCIÃ“N MEJORADA PARA VERIFICAR TARJETAS GUARDADAS
async function checkSavedCards() {
  if (!currentUser) {
    console.log("âš ï¸ No hay usuario logueado, no se pueden verificar tarjetas");
    return;
  }
  
  try {
    console.log("ğŸ” Verificando tarjetas guardadas para usuario:", currentUser.email);
    
    const response = await fetch(`${BACKEND_URL}/api/payments/cards`, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${currentUser.token}`
      }
    });
    
    console.log("ğŸ“¥ Respuesta de tarjetas:", response.status);
    
    if (response.ok) {
      const cards = await response.json();
      const savedCardBtn = document.getElementById('payWithSavedCard');
      
      console.log(`ğŸ’³ Tarjetas encontradas: ${cards.length}`, cards);
      
      if (cards.length > 0) {
        savedCardBtn.classList.remove('hidden');
        // Guardar la primera tarjeta para uso rÃ¡pido
        localStorage.setItem('savedCard', JSON.stringify(cards[0]));
        console.log("âœ… BotÃ³n de tarjeta guardada activado");
        
        // Actualizar el texto del botÃ³n con la tarjeta
        savedCardBtn.innerHTML = `
          <span>ğŸ’³</span>
          <span>Usar Tarjeta Â·Â·Â·Â· ${cards[0].last4}</span>
        `;
      } else {
        savedCardBtn.classList.add('hidden');
        localStorage.removeItem('savedCard');
        console.log("â„¹ï¸ No hay tarjetas guardadas");
      }
    } else {
      console.error("âŒ Error al obtener tarjetas:", response.status);
      const errorText = await response.text();
      console.error("Detalles del error:", errorText);
    }
  } catch (error) {
    console.error("ğŸ’¥ Error de conexiÃ³n al verificar tarjetas:", error);
  }
}

// âœ… FUNCIÃ“N PARA DETECTAR MARCA DE TARJETA EN EL FRONTEND
function detectCardBrand(cardNumber) {
    const cleaned = cardNumber.replace(/\D/g, '');
    
    if (/^4/.test(cleaned)) return 'Visa';
    if (/^5[1-5]/.test(cleaned)) return 'MasterCard';
    if (/^3[47]/.test(cleaned)) return 'American Express';
    if (/^6(?:011|5)/.test(cleaned)) return 'Discover';
    
    return 'Otra';
}

// âœ… ACTUALIZAR LA INTERFAZ AL TECLEAR EL NÃšMERO DE TARJETA
document.addEventListener('DOMContentLoaded', function() {
    const cardNumberInput = document.getElementById('cardNumber');
    if (cardNumberInput) {
        cardNumberInput.addEventListener('input', function() {
            formatCardNumber(this);
            // Opcional: mostrar icono de la marca de la tarjeta
            const brand = detectCardBrand(this.value);
            console.log('Marca detectada:', brand);
        });
    }
});

// âœ… ACTUALIZA la funciÃ³n logout existente
function logout() {
  localStorage.removeItem('currentUser');
  localStorage.removeItem('savedCard'); // âœ… NUEVA LÃNEA
  currentUser = null;
  updateAuthUI();
  document.getElementById('accountModal').classList.add('hidden');
  
  // âœ… OCULTAR BOTÃ“N DE TARJETA GUARDADA
  const savedCardBtn = document.getElementById('payWithSavedCard');
  if (savedCardBtn) {
    savedCardBtn.classList.add('hidden');
  }
  
  console.log('âœ… SesiÃ³n cerrada correctamente');
}

// Inicializar UI al cargar la pÃ¡gina
document.addEventListener('DOMContentLoaded', function() {
    updateAuthUI();
});

// =============================================
// MENÃš MÃ“VIL - VERSIÃ“N 100% FUNCIONAL
// =============================================

// Variable global para el menÃº mÃ³vil
let mobileMenu = null;

// FunciÃ³n para inicializar el menÃº mÃ³vil
function initMobileMenu() {
    mobileMenu = document.getElementById('mobileMenu');
    
    if (!mobileMenu) {
        mobileMenu = document.createElement('div');
        mobileMenu.id = 'mobileMenu';
        mobileMenu.className = 'md:hidden absolute top-full left-0 right-0 bg-gradient-to-br from-orange-500 to-orange-600 shadow-lg z-50';
        
        mobileMenu.innerHTML = `
            <div class="flex flex-col space-y-4 p-6">
                <button class="mobile-account-btn text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg">
                    Cuenta ğŸ‘¤
                </button>
                <a class="text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg" href="#inicio">Inicio</a>
                <a class="text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg" href="#menu">MenÃº</a>
                <a class="text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg" href="#nosotros">Nosotros</a>
                <a class="text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg" href="#contacto">Contacto</a>
                <button class="mobile-help-btn text-white hover:text-orange-200 font-medium transition-colors text-left py-3 text-lg">
                    Ayuda
                </button>
                
                <button class="mobile-cart-btn bg-white bg-opacity-20 text-white px-6 py-4 rounded-full font-semibold hover:bg-white hover:bg-opacity-30 transition-colors flex items-center space-x-3 justify-center mt-4 text-lg">
                    <span>ğŸ›’ Carrito</span>
                    <span class="bg-orange-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mobile-cart-count">0</span>
                </button>
            </div>
        `;
        
        document.querySelector('header nav').appendChild(mobileMenu);
        
        // Asignar eventos a los botones
        assignMobileMenuEvents();
        
        // Ocultar el menÃº inicialmente
        mobileMenu.classList.add('hidden');
    }
    
    return mobileMenu;
}

// FunciÃ³n para asignar eventos del menÃº mÃ³vil
function assignMobileMenuEvents() {
    if (!mobileMenu) return;
    
    // BotÃ³n cuenta mÃ³vil
    const mobileAccountBtn = mobileMenu.querySelector('.mobile-account-btn');
    if (mobileAccountBtn) {
        mobileAccountBtn.addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('accountModal').classList.remove('hidden');
            setTimeout(() => {
                const modalContent = document.querySelector('#accountModal > div');
                if (modalContent) {
                    modalContent.classList.replace('scale-95', 'scale-100');
                }
            }, 10);
            closeMobileMenu();
        });
    }
    
    // BotÃ³n ayuda mÃ³vil
    const mobileHelpBtn = mobileMenu.querySelector('.mobile-help-btn');
    if (mobileHelpBtn) {
        mobileHelpBtn.addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('helpModal').classList.remove('hidden');
            closeMobileMenu();
        });
    }
    
    // BotÃ³n carrito mÃ³vil
    const mobileCartBtn = mobileMenu.querySelector('.mobile-cart-btn');
    if (mobileCartBtn) {
        mobileCartBtn.addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('cartModal').classList.remove('hidden');
            closeMobileMenu();
        });
    }
    
    // Enlaces que cierran el menÃº
    const menuLinks = mobileMenu.querySelectorAll('a[href]');
    menuLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            closeMobileMenu();
        });
    });
}

// Evento principal para el botÃ³n del menÃº hamburguesa
document.getElementById('mobileMenuButton').addEventListener('click', function(e) {
    e.stopPropagation();
    
    // Inicializar el menÃº si no existe
    if (!mobileMenu) {
        mobileMenu = initMobileMenu();
    }
    
    // Actualizar contador del carrito mÃ³vil
    updateMobileCartCount();
    
    // Alternar visibilidad del menÃº
    mobileMenu.classList.toggle('hidden');
});

// FunciÃ³n para actualizar contador del carrito mÃ³vil
function updateMobileCartCount() {
    if (!mobileMenu) return;
    
    const mobileCartCount = mobileMenu.querySelector('.mobile-cart-count');
    const cartCount = document.getElementById('cartCount');
    if (mobileCartCount && cartCount) {
        mobileCartCount.textContent = cartCount.textContent;
    }
}

// FunciÃ³n para cerrar menÃº mÃ³vil
function closeMobileMenu() {
    if (mobileMenu) {
        mobileMenu.classList.add('hidden');
    }
}

// Cerrar menÃº al hacer clic fuera
document.addEventListener('click', function(event) {
    if (!mobileMenu) return;
    
    const menuButton = document.getElementById('mobileMenuButton');
    const isClickInsideMenu = mobileMenu.contains(event.target);
    const isClickOnMenuButton = event.target === menuButton || menuButton.contains(event.target);
    
    if (!isClickInsideMenu && !isClickOnMenuButton) {
        closeMobileMenu();
    }
});

// Prevenir que el menÃº se cierre al hacer clic dentro
if (mobileMenu) {
    mobileMenu.addEventListener('click', function(event) {
        event.stopPropagation();
    });
}

// =============================================
// MODAL DE AYUDA - VERSIÃ“N CORREGIDA
// =============================================

// Event listener para abrir ayuda
document.getElementById('helpButton').addEventListener('click', function() {
    document.getElementById('helpModal').classList.remove('hidden');
});

// Event listener para cerrar ayuda
document.getElementById('closeHelpModal').addEventListener('click', function() {
    document.getElementById('helpModal').classList.add('hidden');
});

// Cerrar modal al hacer clic fuera
document.getElementById('helpModal').addEventListener('click', function(e) {
    if (e.target.id === 'helpModal') {
        document.getElementById('helpModal').classList.add('hidden');
    }
});

// Cerrar con tecla Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && !document.getElementById('helpModal').classList.contains('hidden')) {
        document.getElementById('helpModal').classList.add('hidden');
    }
});

// =============================================
// INICIALIZACIÃ“N AL CARGAR LA PÃGINA
// =============================================

document.addEventListener('DOMContentLoaded', function() {
    // Inicializar el menÃº mÃ³vil
    initMobileMenu();
    
    // Actualizar contador del carrito mÃ³vil
    updateMobileCartCount();
});

// =============================================
// FUNCIONES DE BÃšSQUEDA
// =============================================

function searchContent() {
    const input = document.getElementById('searchInput').value.toLowerCase();
    const cards = document.querySelectorAll('#helpContent .card');
    const resultsContainer = document.getElementById('resultsContainer');
    const resultsList = document.getElementById('resultsList');
    resultsList.innerHTML = '';
    let found = false;

    cards.forEach(card => {
        const text = card.innerText.toLowerCase();
        if (text.includes(input) && input.trim() !== '') {
            const title = card.querySelector('h3').innerText;
            const li = document.createElement('li');
            li.innerHTML = `<a href="#" class="text-orange-500 hover:text-orange-600" onclick="scrollToCard('${title}')">${title}</a>`;
            resultsList.appendChild(li);
            found = true;
        }
    });

    resultsContainer.classList.toggle('hidden', !found);
    if (!found && input.trim() !== '') {
        resultsList.innerHTML = '<li class="text-gray-500">No se encontraron resultados.</li>';
        resultsContainer.classList.remove('hidden');
    }
}

function scrollToCard(title) {
    const cards = document.querySelectorAll('#helpContent .card');
    cards.forEach(card => {
        if (card.querySelector('h3').innerText === title) {
            card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            card.style.backgroundColor = '#fef3cd';
            setTimeout(() => {
                card.style.backgroundColor = '';
            }, 2000);
        }
    });
}

// =============================================
// DELIVERY MODAL LOGIC
// =============================================

// Abrir modal de Delivery Gratis
document.querySelectorAll('button').forEach(btn => {
    // Skip buttons that are inside modals (ids ending with 'Modal')
    if (btn.closest && btn.closest('[id$="Modal"]')) return;
  if (btn.textContent.includes('Delivery Gratis')) {
    btn.addEventListener('click', () => {
      document.getElementById('deliveryModal').classList.remove('hidden');
      setTimeout(() => {
        document.querySelector('#deliveryModal > div').classList.replace('scale-95', 'scale-100');
      }, 10);
    });
  }
});

// Cerrar modal
document.getElementById('cancelDelivery').addEventListener('click', () => {
  document.getElementById('deliveryModal').classList.add('hidden');
});

// Guardar direcciÃ³n
const form = document.getElementById('deliveryForm');
const inputs = ['calle', 'colonia', 'municipio', 'numeroInterior', 'descripcion'];

window.addEventListener('DOMContentLoaded', () => {
  const saved = JSON.parse(localStorage.getItem('direccionEntrega') || '{}');
  for (let id of inputs) if (saved[id]) document.getElementById(id).value = saved[id];
});

form.addEventListener('submit', (e) => {
  e.preventDefault();
  if (document.getElementById('guardarDireccion').checked) {
    const data = {};
    inputs.forEach(id => data[id] = document.getElementById(id).value);
    localStorage.setItem('direccionEntrega', JSON.stringify(data));
    alert('DirecciÃ³n guardada correctamente âœ…');
  } else {
    alert('DirecciÃ³n registrada temporalmente âœ…');
  }
  document.getElementById('deliveryModal').classList.add('hidden');
});

// =============================================
// MODAL LOGIC BÃSICA
// =============================================

document.getElementById('cartButton').addEventListener('click', function() {
    document.getElementById('cartModal').classList.remove('hidden');
});

document.getElementById('closeCart').addEventListener('click', function() {
    document.getElementById('cartModal').classList.add('hidden');
});

document.getElementById('cartModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});

document.getElementById('friesModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});

document.getElementById('drinkModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});

document.getElementById('wingsModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
        resetWingsModal();
    }
});

document.getElementById('breadModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
        resetBreadModal();
    }
});

// Account modal logic
document.getElementById('accountButton').addEventListener('click', () => {
  const modal = document.getElementById('accountModal');
  modal.classList.remove('hidden');
  setTimeout(() => modal.children[0].classList.replace('scale-95', 'scale-100'), 10);
});

document.getElementById('closeAccountModal').addEventListener('click', () => {
  const modal = document.getElementById('accountModal');
  modal.classList.add('hidden');
});

// Abrir formularios
document.getElementById('openRegister').addEventListener('click', () => {
  document.getElementById('accountModal').classList.add('hidden');
  document.getElementById('registerModal').classList.remove('hidden');
});

document.getElementById('openLogin').addEventListener('click', () => {
  document.getElementById('accountModal').classList.add('hidden');
  document.getElementById('loginModal').classList.remove('hidden');
});

// Cerrar formularios
document.getElementById('closeRegister').addEventListener('click', () => {
  document.getElementById('registerModal').classList.add('hidden');
});

document.getElementById('closeLogin').addEventListener('click', () => {
  document.getElementById('loginModal').classList.add('hidden');
});

// Cerrar si se hace clic fuera del contenido
['accountModal', 'registerModal', 'loginModal'].forEach(id => {
  document.getElementById(id).addEventListener('click', e => {
    if (e.target.id === id) e.target.classList.add('hidden');
  });
});

// Conectar botones de refrescos
document.querySelectorAll('button').forEach(btn => {
  if (btn.textContent && (btn.textContent.includes('Refresco') || btn.textContent.includes('Coca') || btn.textContent.includes('Fanta') || btn.textContent.includes('Sprite') || btn.textContent.includes('Agua'))) {
    btn.addEventListener('click', (e) => {
      openModal('drinkModal');
    });
  }
});

// Conectar los botones de Refrescos Helados con su modal
document.querySelectorAll('#menu button, section button').forEach(btn => {
  if (btn.textContent.includes('+ ğŸ›’')) {
    btn.addEventListener('click', (e) => {
      const card = e.target.closest('.p-4');
      const drinkName = card.querySelector('h5')?.textContent.trim() || 'Refresco';
      document.getElementById('modalDrinkName').textContent = drinkName;

      // Asignar precio base segÃºn el refresco
      let basePrice = 25; // Default
      if (drinkName.toLowerCase().includes('agua')) basePrice = 15;
      if (drinkName.toLowerCase().includes('fanta')) basePrice = 25;
      if (drinkName.toLowerCase().includes('sprite')) basePrice = 25;
      if (drinkName.toLowerCase().includes('coca')) basePrice = 25;

      // Guardar precio base en dataset
      document.getElementById('drinkModal').dataset.basePrice = basePrice;

      // Reinicia valores por si quedÃ³ de otra bebida
      document.querySelectorAll('input[name="drinkSize"]').forEach(r => r.checked = r.value === 'pequeÃ±o');
      document.querySelectorAll('input[name="ice"]').forEach(r => r.checked = r.value === 'hielo-normal');
      document.getElementById('drinkQuantity').textContent = '1';

      // Mostrar precio inicial
      const totalPriceEl = document.getElementById('drinkTotalPrice');
      totalPriceEl.textContent = '$' + basePrice.toFixed(2) + ' MXN';

      // Mostrar modal
      document.getElementById('drinkModal').classList.remove('hidden');
      setTimeout(() => {
        document.querySelector('#drinkModal > div').classList.replace('scale-95', 'scale-100');
      }, 10);
    });
  }
});

// Ajustar el cÃ¡lculo dinÃ¡mico de precio en el modal de bebida
(function(){
  const modal = document.getElementById('drinkModal');
  if(!modal) return;
  const qtyEl = document.getElementById('drinkQuantity');
  const totalEl = document.getElementById('drinkTotalPrice');

  function calcDrink(){
    const base = Number(modal.dataset.basePrice || 25);
    const size = document.querySelector('input[name="drinkSize"]:checked').value;
    let extra = 0;
    if(size === 'mediano') extra = 5;
    if(size === 'grande') extra = 10;
    const qty = Number(qtyEl.textContent);
    const total = (base + extra) * qty;
    totalEl.textContent = '$' + total.toFixed(2) + ' MXN';
    return total;
  }

  document.getElementById('increaseDrinkQty').addEventListener('click', () => {
    qtyEl.textContent = Number(qtyEl.textContent) + 1;
    calcDrink();
  });
  document.getElementById('decreaseDrinkQty').addEventListener('click', () => {
    const val = Number(qtyEl.textContent);
    if(val > 1) qtyEl.textContent = val - 1;
    calcDrink();
  });
  document.querySelectorAll('input[name="drinkSize"]').forEach(r => r.addEventListener('change', calcDrink));
  calcDrink();
})();

// Mejora: hacer que todos los botones de "Cancelar" cierren su modal correspondiente
document.querySelectorAll('button').forEach(btn => {
  if (btn.textContent.trim().toLowerCase() === 'cancelar') {
    btn.addEventListener('click', () => {
      const modal = btn.closest('[id$="Modal"]');
      if (modal) modal.classList.add('hidden');
    });
  }
});

// Mejora: Formato MXN en precios ya manejado en todo el cÃ³digo
// (Las funciones de formato existentes ya usan pesos, se mantiene fmt() con MXN).
</script>
</body>
</html>